# Linux笔记总结



## vim

```
vim 文件名  #进入命令模式
:  #输入命令；回车结束
:wq  #退出vim
```

```
i\a\o  #进入编辑模式
Esc  #退出并回到命令模式
```

### 保存和退出

| 命令            | 作用                                             |
| --------------- | ------------------------------------------------ |
| **:w**          | 保存修改                                         |
| :w 文件名       | 另存为指定文件                                   |
| :w >> a.txt     | 内容追加到a.txt中（文件需存在）                  |
| **:wq**         | 保存修改并退出                                   |
| shift + zz \ ZZ | 快捷键，保存修改并退出                           |
| **:q!**         | 不保存修改退出                                   |
| :wq!            | 保存修改并退出（文件所有者可忽略文件的只读属性） |

### 插入命令

| 命令          | 作用                           |
| ------------- | ------------------------------ |
| a             | 在光标**后**附加文本           |
| i             | 在光标**前**插入文本           |
| o             | 在光标**下**插入新行           |
| shift + a \ A | 在本行**行末**附加文本（行尾） |
| shift + i \ I | 在本行**开始**插入文本（行首） |
| shift + o \ O | 在光标**上**插入新行           |

### 删除命令

| 命令    | 作用                                           |
| ------- | ---------------------------------------------- |
| x       | 删除光标所在处字符；nx 删除光标所在处后n个字符 |
| dd      | 删除光标所在行；ndd删除n行                     |
| :n1,n2d | 删除指定范围的行（`$ 1,3d`删除了123这三行）    |
| dG      | 删除光标所在行到末尾的内容                     |
| D       | 删除从光标所在处到行尾                         |

### 复制和剪切命令

| 命令       | 作用                           |
| ---------- | ------------------------------ |
| yy  \  Y   | 复制当前行                     |
| nyy  \  nY | 复制当前行以下n行              |
| dd         | 剪切当前行                     |
| ndd        | 剪切当前行以下n行              |
| p  \  P    | 粘贴在当前光标所在行下 或 行上 |

### 搜索和替换命令

| 命令                    | 作用                                 |
| ----------------------- | ------------------------------------ |
| /[string]               | 向后搜索指定字符串  搜索时忽略大小写 |
| ?[string]               | 向前搜索指定字符串                   |
| n                       | 寻找搜索条件的下一个字符             |
| N  \  Shift + n         | 寻找搜索条件的上一个字符             |
| r                       | 修改光标所在处字符                   |
| R  \  shift  + r        | 从光标所在处开始修改字符，按Esc结束  |
| :%s/旧字符/新字符/gc    | 全文替换指定字符串                   |
| :n1,n2s/旧字符/新字符/g | 在一定范围内替换指定字符串           |

% 指全文，n1,n2 范围行数，s/ 指开始标志，/g 指结尾标志，/c 询问确认

**提示：**如果替换的文本包括了一些特殊字符，如 \ * 等，可以使用\符号转义，例：把/root替换为/ROOT `%s/\/root/\/ROOT/g`

### 定位命令

| 命令      | 作用               |
| --------- | ------------------ |
| :set nu   | 设置行号           |
| :set nonu | 取消行号           |
| :n        | 到第n行            |
| gg        | 到第一行           |
| G         | 到最后一行         |
| nG        | 到第n行（如：7G）  |
| nl        | 到某一列（如：4l） |

### 其他命令

| 命令            | 作用                                 |
| --------------- | ------------------------------------ |
| **u**           | undo，取消上一步操作                 |
| ctrl + r        | redo，返回到undo之前                 |
| **v**           | 可视字符模式（类似于鼠标的选中拖动） |
| V  \  shift + v | 可视行模式，选择多行操作             |
| ctrl + v        | 可视块模式（列模式），操作列         |
| **:!命令语句**  | vi里面查询命令                       |
| :r !命令语句    | vi里面导入命令的结果                 |





## 文件与目录的查看

### ls

```
作用：显示目录文件
命令路径：/bin/ls
语法：ls [参数] 文件或目录
-a (all)显示所有文件，注意隐藏文件，特殊目录.和.. 
-l (long)显示详细信息
-R (recursive)递归显示当前目录下所有目录
-r (reverse)逆序排序
-t (time)按修改时间排序（降序）

ll  相当于 ls –l
```

### cd

```
作用：切换目录
语法：cd 目录或参数
/  切换到根目录
.. 回到上一级目录
.  当前目录
-  显示并打开到上一次操作的目录
~  当前用户的宿主目录（eg:# cd ~用户名  进入某个用户的家目录）
```

### pwd

```
作用：显示当前工作目录
命令路径：/bin/pwd
语法：pwd [参数]
-L 显示链接路径，当前路径，默认
-P 物理路径
```

### cat

```
作用：显示文件内容
命令路径：/bin/cat
语法：cat [参数] 文件名
-A  显示所有内容，包括隐藏的字符
-n	显示行号

例：
$ cat -n /etc/services
```

### tac

```
作用：倒序显示文件内容
语法：cat 文件名
```

`tac`为`cat`的倒写形式，查看的文件内容也是以行为单位倒序显示。该命令的倒序功能可以应用于日志的查看中，用于查看最新日志信息

### more

```
作用：分页显示文件内容
命令路径：/bin/more
语法：more 文件名
-[number] 指定分页大小，默认分页大小为填满终端页面
+[number] 指定行开始显示
+/[string] 搜索指定内容，并从其前两行开始显示
-s 合并多个空行为一行

操控：
空格或f    显示下一页
b		  显示上一页
Enter键   显示下一行
q或Q      退出

例：每页显示两行，从第四行开始显示
$ more -2 +4 test.file
```

与其相似的还有`less`命令，其比more拥有更多的功能，比如：+F 持续跟踪添加内容，需要`ctrl+c`才能退出命令；-N 显示行号

### head

```
作用：查看文件前几行（默认10行）
命令路径：/usr/bin/head
语法：head [参数] 文件名
-n 指定行数

例：
head -20 /etc/services
```

### tail

```
作用：查看文件的后几行（默认10行）
命令路径：/usr/bin/tail
语法：tail [参数] 文件名
-n 指定行数，当数字前面有个+号时，用于反选，显示从第几行开始后的文件内容
-f (follow)显示文件实时追加的内容，与less -F命令类似

例：显示后4行内容
tail -n 4 test.file
例：显示第4行之后的所有内容
tail -n +4 test.file
```





## 文件与目录的修改

### mkdir

```
作用：创建新目录
命令路径：/bin/mkdir
语法：mkdir [参数] 目录名
-p (parents)父目录不存在情况下先生成父目录

例：
$ mkdir linux/test #如果目录linux不存在，则报错，使用参数-p即可自动创建父目录
```

### touch

```
作用：创建空文件或更新已存在文件的时间
命令路径：/bin/touch
语法：touch 文件名

例：同时创建多个文件
$ touch {a.txt, b.txt}
例：创建带空格的文件(在查询和删除时也必须带双引号)
$ touch "program files"
```

### cp

```
作用：复制文件或目录
命令路径：/bin/cp
语法：cp [参数] 源文件或目录 目的目录
-r -R (recursive)递归处理，复制目录
-p 保留文件属性（原文件的时间不变）

例：相对路径
$ cp –R ../aaa  ../../test/
例：绝对路径
$ cp –R /ect/service  /root/test/aa/bb
```

### mv

```
作用：移动文件或目录、文件或目录改名
命令路径：/bin/mv
语法：mv 源文件或目录 目的目录
```

### rm

```
作用：删除文件
命令路径：/bin/rm
语法：rm [参数] 文件或目录
-r (recursive)删除目录，同时删除该目录下的所有文件
-f (force)强制删除文件或目录 即使原档案属性设为唯读,亦直接删除,无需逐一确认
```

**扩展点：**删除乱码文件

一些文件乱码后使用`rm -rf`依然无法删除，此时使用`ll -i`查找到文件的inode节点然后使用`find . -inum`查找到的inode编号`-exec rm {} -rf \;`就能顺利删除了

### ln

```
作用：产生链接文件
语法：ln [参数] 源文件(使用绝对路径) 目标文件
-s 创建软链接；以路径的形式存在，类似于Windows中的快捷方式
```

**硬链接和软连接的区别：**

**软链接**：

-   软链接，以路径的形式存在。类似于Windows操作系统中的快捷方式
-   软链接可以跨文件系统
-   软链接可以对目录进行链接
-   软链接可以对一个不存在的文件名进行链接

**硬链接**：

-   硬链接，以文件副本的形式存在。但不占用实际空间
-   硬链接只有在同一个文件系统中才能创建
-   不允许给目录创建硬链接

**软连接格式特征：**

```
lrwxrwxrwx. 1 root root   13 Jul 20 07:50 service -> /etc/services

软连接的文件类型是 l（软连接），软连接文件的权限都是 lrwxrwxrwx
-> 箭头指向到源文件
```





## 文件与目录的搜索

### find

```
作用：查找文件或目录
命令路径：/bin/find
语法：find [搜索路径] 参数 匹配条件
-name  按名称查找，精准查找
-iname 按名称查找
-size  按文件大小查找；以block为单位，一个block是512B, 1K=2block；+大于，-小于，不写是等于
-type  按文件类型查找；f二进制文件、l软连接文件、d目录、c字符文件

例：
$ find /dev -type c
$ find . –name *g

例：在etc目录下找出大于100MB的文件；100MB=102400KB=204800block
$ find /etc -size -204800

例：在目录/etc中查找以init开头的，且后面有三位的文件
$ find /etc -name "init???"
```

**提示：**如果没有指定搜索路径，默认从当前目录查找

**find查找中的字符匹配：** `*`：匹配所有	`?`：匹配单个字符；模糊匹配的条件，建议使用单引号或双引号括起来。如果`*`被转义，可使用单双引号括住查询条件，或者使用`\*`

### grep

```
作用：在文件中搜寻字串匹配的行并输出
命令路径：/bin/grep
语法：grep [参数] "搜寻字符串" 文件名或文件路径
-c 输出匹配行的次数（是以行为单位，不是以出现次数为单位，一行匹配到多个算一次）
-i 忽略大小写
-n 显示匹配行及行号
-v 反向选择，显示不包含匹配文本的所有行

例：
$ grep ftp /etc/services

例：去掉文件行首的#号
$ grep -v ^# /etc/inittab

例：显示在inittab文件中，init匹配行及行号
$ grep -n "init" /etc/inittab

例：显示在inittab文件中，init匹配了多少次
$ grep -c "init" /etc/inittab
```

### which

```
作用：显示系统命令所在目录（绝对路径及别名）
命令路径：/usr/bin/which
语法：which 命令

例：
$ which passwd
```

which命令的作用是，在PATH变量指定的路径中，搜索某个系统命令的位置，并且返回第一个搜索结果。也就是说，使用which命令，就可以看到某个系统命令是否存在，以及执行的到底是哪一个位置的命令

### whereis

```
作用：搜索命令所在目录、配置文件所在目录、及帮助文档路径（比which命令显示的更多）
命令路径：/usr/bin/whereis
语法：whereis 命令
```

### whatis

```
作用：简要说明，详细说明可以使用info命令，格式：info 命令
语法：whatis 命令
```

`whatis`和`man`命令可以配合使用。

使用`whatis`会显示命令所在的具体的文档类别，例如：

```
$ whatis passwd
passwd (5)           - 密码文件
passwd (1)           - 更改用户密码
passwd (1ssl)        - compute password hashes
```

可以看到`passwd`在分类1和分类5中都有，如果想看分类5的帮助，可以使用`man`：

```
$ man 5 passwd
$ man -k keyword  # -k:查询关键字
```

从而查询到符合关键字的部分





## 网络通信命令

### ping

```
作用：测试网络的连通性
命令路径：/bin/ping
语法：ping [参数] IP地址
-c  指定发送次数

例：
$ ping -c 3 127.0.0.1
```

### ifconfig

```
作用：查看和设置网卡网络配置
命令路径：/sbin/ifconfig
语法：ifconfig [参数] [网卡设备标识]
-a  显示所有网卡信息
```

### netstat

```
作用：主要用于检测主机的网络配置和状况
命令路径：/bin/netstat
语法：netstat [参数]
-a	all显示所有连接和监听端口
-t	(tcp)仅显示tcp相关选项
-u	(udp)仅显示udp相关选项
-n	使用数字方式显示地址和端口号
-l	(listening)显示监控中的服务器的socket

例：
$ netstat -au  #列出所有udp端口 
$ nestat -at  #列出所有tcp端口
$ netstat -an  #查看本机所有的网络连接
```





## 磁盘管理

### df

```
作用：用于查看Linux文件系统的状态信息，显示各个分区的容量、已使用量、未使用量及挂载点等信息。看剩余空间
语法：df [参数] [挂载点]
-h	(human-readable)根据磁盘空间和使用情况，以易读的方式显示KB,MB,GB等
-k	以KB为单位显示各分区的信息，默认
-M	以MB为单位显示信息
-a	显示所有分区包括大小为0的分区
```

### du

```
作用：用于查看文件或目录的大小（磁盘使用空间）
语法：du [参数] 文件名目录
-a	显示子文件的大小
-h	以易读的方式显示KB,MB,GB等
-s	(summarize)统计总占有量

例：以易读的单位显示/home目录的总大小
du -sh /home

例：以K,M,G为单位显示/home文件夹下各个子目录的大小
du -h /home
```

**df命令和du命令的区别：**df命令是从文件系统考虑的，不仅考虑文件占用的空间，还要统计被命令或者程序占用的空间

### free

```
作用：查看内存及交换空间使用状态
语法：free [参数]
-k	以KB为单位显示，默认就是以KB为单位显示
-m	以MB为单位显示
-g	以GB为单位显示
```





## 压缩

### gzip

```
作用：压缩（解压）文件，压缩文件后缀为.gz
命令路径：/usr/bin/which
语法：gzip 文件
-d  (decompress)将压缩文件解压
```

**提示：**gzip只能压缩文件，不能压缩目录；不保留原文件。解压使用gzip –d或者gunzip

### bzip2 

```
作用：压缩（解压）文件,压缩文件后缀为.bz2
命令路径：/usr/bin/bzip2
语法：bzip2 [参数] 文件
-k	产生压缩文件后保留原文件（压缩比高）
-d	解压缩的参数（decompress）
```

解压使用bzip2 –d或者bunzip2

### zip

```
作用：压缩（解压）文件,压缩文件后缀为.zip
命令路径：/usr/bin/zip
语法：zip [参数] 压缩后文件名称 文件或目录
-r	压缩目录

例：压缩文件
$ zip services.zip /etc/services
例：压缩目录
$ zip -r test.zip /test
```

解压使用unzip

### tar

```
作用：文件、目录打（解）包
命令路径：/bin/tar
语法：tar [参数] 压缩后文件名 文件或目录
-c	(create)建立一个压缩文件的参数指令，后缀是.tar
-x	(extract)解开一个压缩文件的参数指令
-z	以gzip命令压缩/解压缩，文件格式.tar.gz
-j	以bzip2命令压缩/解压缩，文件格式.tar.bz2
-v	(verbose)压缩的过程中显示文件
-f	(file)指定文件名，必选项

例：
$ tar –zcvf  #压缩    
$ tar –zxvf  #解压

例：使用gzip将目录dir1打包并压缩文件dir1.tar.gz
$ tar –zcvf dir1.tar.gz dir1

例：解压到指定的/root目录
$ tar -zxvf dir1.tar.gz -C /root

例：将当前目录的文件打包为bak.tar
$ tar -cvf bak.tar .
```





## 用户管理

### su

```
作用：切换用户
语法：su [参数] 用户名
-    表示用户的环境变量一起切换
-c  仅执行一次命令，而不切换用户身份

例：切换root用户
$ su – root
```

### useradd

```
作用：添加用户
语法：useradd 用户名
```

### passwd

```
作用：修改密码
语法：passwd 用户名

例：创建新用户
$ useradd 用户名
$ passwd 用户名
$ su 用户名 
```

**注意：**创建用户账号必须在root账户下进行，设置完密码后才可以切换用户

### userdel

```
作用：删除用户
语法：userdel [参数] 用户名
-r 删除账号时同时删除宿主目录（remove）
```





## 进程管理

### ps

```
作用：查看系统中的进程信息
语法：ps [参数]
-a	显示所有用户的进程
-e	显示所有进程，包括没有控制终端的进程(等同于-A)
-u	显示用户名和启动时间

-l	长格式显示
-f  完整列表

例：查看系统中所有进程
$ ps -le

例：查看指定进程信息
$ ps -ef | grep init
```

### pstree

```
作用：查看当前进程树
语法：pstree [参数]
-p	显示进程PID
-u	显示进程的所属用户
```

### top

```
作用：显示当前系统中耗费资源最多的进程,以及系统的一些负载情况
语法：top [参数]
-d 秒数，指定几秒刷新一次，默认3秒（动态显示）
```

### kill

```
作用：关闭进程
语法：kill [参数] pId
-1	(HUP)重新加载进程
-9	(KILL)杀死一个进程
-15	(TERM)正常停止一个进程

例：
$ kill -9	#进程号（强行关闭）
$ kill -1	#进程号（重启进程）
```





## 权限管理

```
示例：-rwxrw-r--

r: 读权限 或 可以查看目录
w: 写权限 或 可以在目录中删除创建
x: 执行权限 或 可以进入目录
用数字来表示：r=4，w=2，x=1，-=0

第1位：	文件类型（d目录，-普通文件，i链接文件，f二进制文件）
第2-4位：	所属用户（所有者）权限，用u(user)表示
第5-7位：	所属组权限，用g(group)表示
第8-10位：	其他用户（其他人）权限，用o(other)表示
第2-10位：	表示所有权限，用a(all)表示
```

### chmod

```
作用：改变文件或目录权限
语法：chmod [{ugoa}{+-=}{rwx}] 文件名或目录
-R	下面的文件和子目录做相同权限操作

例：
$ chmod u+x,o-x a.txt
$ chmod  750  b.txt
```

### chown

```
作用：更改文件或者目录的所有者
语法：chown 用户[:所属组] 文件
-R	递归修改

例：把file1文件的所有者改为用户lee
$ chown lee file1

例：把file1文件的所有者改为用户lee，所属组改为test
$ chown lee:test file1

例：修改dir及其子目录的所有者和所属组
$ chown –R lee:test dir
```

### chgrp

```
作用：改变文件或目录的所属组
语法：chgrp 所属组 文件

例：把test.log的所属组修改为root
chgrp root test.log
```





## 帮助

### man

```
作用：获取命令或配置文件的帮助信息
语法：man 命令/配置文件

操控：
空格      显示下一页
Enter键   显示下一行
q或Q      退出
/[string] 定位搜索
n         查找下一个
shift+n   查找上一个

例：
$ man ls
例：
$ man services
```

**提示：**查看配置文件时，不需要配置文件的绝对路径，只需要文件名即可

在`man`的帮助手册中，将帮助文档分为了9个类别：

1. 用户可以操作的命令或者是可执行文件
2. 系统核心可调用的函数与工具等
3. 一些常用的函数与数据库
4. 设备文件的说明
5. 设置文件或者某些文件的格式
6. 游戏
7. 惯例与协议等。例如Linux标准文件系统、网络协议、ASCⅡ码等说明内容
8. 系统管理员可用的管理条令
9. 与内核有关的文件

可以使用命令显示指定类型的内容：

```
$ man 5 passwd
```

### help

```
作用：查看shell内置命令的帮助信息
语法：help 命令  或者  命令 --help

例：
$ help cd
$ cd --help
```

**注意：**内置命令，使用whereis, which, man都不能查看





## 关机

### shutdown

```
作用：关机或者重启
语法：shutdown [选项] [时间]
-c  取消前一个关机命令   
-h  关机   
-r  重启

例：立即关机
$ shutdown -h now

例：定时关机
$ shutdown -h 20:30
```

**其他关机命令：**halt、poweroff、init 0

### reboot

```
作用：重启系统

例：立即重启
$ reboot -h now
```

**其他重启命令：**init 6





## Linux目录结构

```
/
├── root #存放root用户的相关文件
|     ├── Desktop
|     ├── Maildir
|     └── ....
|
├── bin #存放系统命令的目录，所有用户都可以执行
├── boot #启动Linux时使用的一些核心文件，包括连接文件以及镜像文件
├── dev #存放设备文件
├── etc #系统配置文件
├── home #用户的主目录，一般该目录名是以用户的账号命名的
├── var #动态数据保存位置，如邮件、日志文件、计划任务等
├── lib #里存放着系统最基本的动态连接共享库，其作用类似于Windows里的DLL文件
├── usr #用户应用程序和文件存放位置，类似program files目录
|     ├── bin
|     ├── lib
|     └──....
|
├── media #挂载目录。 挂载媒体设备，如软盘和光盘
└──....
```





## 快捷键

| 按键         | 作用                      |
| ------------ | ------------------------- |
| **Tab**      | 自动补全                  |
| **ctrl + c** | 停止当前进程              |
| **ctrl + z** | 挂起当前进程，放后台      |
| ctrl + r     | 查看命令历史              |
| ctrl + l     | 清屏，与clear命令作用相同 |
| ↑  ↓         | 上下查看执行过的命令      |
| ctrl + a     | 行首                      |
| ctrl + e     | 行尾                      |
| ctrl + k     | 清除光标后的所有内容      |
| ctrl+ w      | 清除光标前的一个单词      |





## Linux环境配置

### 修改配置文件

```
$ vi /etc/sysconfig/network-scripts/ifcfg-eth0
BOOTPROTO=static
ONBOOT=yes
IPADDR=192.168.2.129
NETMASK=255.255.255.0
GATEWAY=192.168.2.2  #网段2任意，IP地址2固定，网段为vmnet8的设置的IP网段
DNS1=114.114.114.114   
DNS2=8.8.8.8
$ service network restart  #重启网络生效
```

### 修改主机名

临时生效：

```
$ hostname 主机名

查询结果：
$ hostname
```

永久生效：

```
$ vi /etc/sysconfig/network

修改如下内容：
NETWORKING=yes
HOSTNAME=主机名
```

### 修改主机名和ip的映射关系

```
vi /etc/hosts

修改如下内容：
192.168.2.120 www.xxx.cn 别名
```

